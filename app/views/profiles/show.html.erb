<div class="hstack gap-2">
  <%= profile_image(@user, class: "w-25") %>
  <div class="vstack gap-3 justify-content-center">
    <div>
      <h1><%= @user.name %></h1>
    </div>
    <% if current_user.id != @user.id %>
      <div>
        <% if current_user.friends.exists?(id: @user.id) %>
          <%= button_to "Unfriend", unfriend_profile_path, method: :delete, form: { data: { turbo_confirm: "Do you really want to unfriend?" } },
              class: "btn btn-primary" %>
        <% elsif current_user.friend_requests.exists?(friendee_id: @user.id) %>
          Request pending...
        <% elsif @user.friend_requests.exists?(friendee_id: current_user.id) %>
          <%= button_to "Accept friend request", accept_friend_request_profile_path, class: "btn btn-primary" %>
        <% else %>
          <%= button_to "Add to friends", send_friend_request_profile_path, class: "btn btn-primary" %>
        <% end %>
      </div>
    <% else %>
      <div>
        <%= link_to "Edit my profile",  edit_user_registration_path if current_user %>
      </div>
    <% end %>
  </div>
</div>

<% if current_user.id == @user.id || current_user.friends.exists?(id: @user.id) %>
  <div class="row justify-content-center my-5">
    <div class="col-10">
      <% @user.posts.each do |post| %>
        <%= render partial: "posts/post", locals: { post: post } %>
      <% end %>
    </div>
  </div>
<% end %>
